(this.webpackJsonproybotapp=this.webpackJsonproybotapp||[]).push([[0],{196:function(e,t,a){e.exports=a(304)},304:function(e,t,a){"use strict";a.r(t);a(197),a(223),a(225),a(226),a(228),a(229),a(230),a(231),a(232),a(233),a(234),a(235),a(237),a(238),a(239),a(240),a(241),a(242),a(243),a(244),a(245),a(246),a(248),a(249),a(250),a(251),a(252),a(253),a(254),a(255),a(256),a(257),a(258),a(259),a(260),a(261),a(262),a(263),a(264),a(265);var n=a(0),s=a.n(n),i=a(78),r=a.n(i),c=a(49),l=a.n(c),o=a(80),u=a.n(o),d=a(112),m=a(13),h=a(14),p=a(8),v=a(18),b=a(17),f=a(79),g=a.n(f),y=a(119),E=a.n(y),O=(a(274),a(60)),I=a.n(O),j=a(61),k=a.n(j),C=a(38),x=a.n(C),T=a(43),N=a.n(T),w=a(113),P=a.n(w),S=a(11),F=a.n(S),A=a(114),H=a.n(A),q=function(){function e(){Object(m.a)(this,e)}return Object(h.a)(e,null,[{key:"queryGET",value:function(e){var t=new XMLHttpRequest;return t.open("GET","https://pavlentygood.fvds.ru/query.php?method=GET&url=".concat(encodeURIComponent(e)),!1),t.send(),t.responseText}},{key:"queryPOST",value:function(e,t){var a=new XMLHttpRequest;return a.open("POST","https://pavlentygood.fvds.ru/query.php?method=POST&url=".concat(encodeURIComponent(e)),!1),a.setRequestHeader("Content-Type","application/json"),a.send(JSON.stringify(t)),a.responseText}},{key:"getUser",value:function(e){return JSON.parse(this.queryGET("app_info?userId=".concat(e)))}}]),e}(),D=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this)).state={dbinfo:q.getUser(e.userId)},n}return Object(h.a)(a,[{key:"render",value:function(){var e;return s.a.createElement(I.a,{id:this.props.id},this.props.user&&s.a.createElement(N.a,null,s.a.createElement(k.a,null,"RoyBot"),s.a.createElement(P.a,{before:s.a.createElement(H.a,{src:this.props.user.photo_200}),description:null!==(e=this.state.dbinfo.Nick)&&void 0!==e?e:"\u041d\u0435\u0442 \u043d\u0438\u043a\u0430"},"".concat(this.props.user.first_name," ").concat(this.props.user.last_name)),s.a.createElement(F.a,null,s.a.createElement(x.a,{size:"l",level:"2",onClick:this.props.go,"data-to":"com_constructor"},"\u041a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440 \u043a\u043e\u043c\u0430\u043d\u0434"))))}}]),a}(s.a.Component),U=a(12),_=a(118),R=a.n(_),z=a(116),M=a.n(z),G=a(117),J=a.n(G),V=a(62),B=a.n(V),K=a(82),W=a.n(K),L=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(){var e;return Object(m.a)(this,a),(e=t.call(this)).setItem=e.setItem.bind(Object(p.a)(e)),e}return Object(h.a)(a,[{key:"setItem",value:function(){var e=this;this.props.cc.setState((function(t){return t[e.props.item.name].status=!t[e.props.item.name].status,t}))}},{key:"render",value:function(){return s.a.createElement(F.a,null,s.a.createElement(x.a,{size:"l",onClick:this.setItem,disabled:this.props.disabled,mode:this.props.item.status?"destructive":"commerce"},"".concat(this.props.item.status?"\u0423\u0431\u0440\u0430\u0442\u044c":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"," ").concat(this.props.item.rusName)))}}]),a}(s.a.Component),X=a(50),Q=a.n(X),Y=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(){var e;return Object(m.a)(this,a),(e=t.call(this)).selectItemType=e.selectItemType.bind(Object(p.a)(e)),e.setFieldHidden=e.setFieldHidden.bind(Object(p.a)(e)),e.changeField=e.changeField.bind(Object(p.a)(e)),e}return Object(h.a)(a,[{key:"selectItemType",value:function(e){var t=this,a=e.target.value;this.props.cc.setState((function(e){return t.state.item.type=0==a.length?null:a,e}))}},{key:"setFieldHidden",value:function(e){return!(this.state.item.type==e)}},{key:"changeField",value:function(e){var t=this,a=e.currentTarget.name,n=e.currentTarget.value;this.props.cc.setState((function(e){return""!=n&&"text"!=a&&isNaN(n)||(t.state.item[a]=n),e}))}},{key:"render",value:function(){return s.a.createElement(N.a,{hidden:!this.state.item.status,header:s.a.createElement(B.a,{mode:"secondary"},this.state.item.rusName)},this.fields())}}]),a}(s.a.Component),Z=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this)).state={item:e.item},n}return Object(h.a)(a,[{key:"fields",value:function(){return s.a.createElement(Q.a,null,s.a.createElement(F.a,null,s.a.createElement(U.d,{type:"text",placeholder:"\u0422\u0435\u043a\u0441\u0442 \u043a\u043e\u043c\u0430\u043d\u0434\u044b",name:"text",onChange:this.changeField})))}}]),a}(Y),$=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this)).state={item:e.item},n}return Object(h.a)(a,[{key:"fields",value:function(){return s.a.createElement(Q.a,null,s.a.createElement(F.a,null,s.a.createElement(U.e,{placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0442\u0438\u043f",onChange:this.selectItemType},s.a.createElement("option",{value:"id"},"\u041f\u043e ID"),s.a.createElement("option",{value:"last"},"\u041f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439"),s.a.createElement("option",{value:"pinned"},"\u0417\u0430\u043a\u0440\u0435\u043f\u043b\u0435\u043d\u043d\u044b\u0439"),s.a.createElement("option",{value:"number"},"\u041f\u043e \u043f\u043e\u0440\u044f\u0434\u043a\u043e\u0432\u043e\u043c\u0443 \u043d\u043e\u043c\u0435\u0440\u0443"))),s.a.createElement(F.a,{hidden:null==this.state.item.type},s.a.createElement(U.d,{type:"text",placeholder:"ID \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0430",name:"owner",value:this.state.item.owner,onChange:this.changeField})),s.a.createElement(F.a,{hidden:this.setFieldHidden("id")},s.a.createElement(U.d,{type:"text",placeholder:"ID \u043f\u043e\u0441\u0442\u0430",name:"id",value:this.state.item.id,onChange:this.changeField})),s.a.createElement(F.a,{hidden:this.setFieldHidden("number")},s.a.createElement(U.d,{type:"text",placeholder:"\u041f\u043e\u0440\u044f\u0434\u043a\u043e\u0432\u044b\u0439 \u043d\u043e\u043c\u0435\u0440",name:"number",value:this.state.item.number,onChange:this.changeField})))}}]),a}(Y),ee=a(81),te=a(120),ae=a(48),ne=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this)).state={item:e.item},n.getIdsMap=n.getIdsMap.bind(Object(p.a)(n)),n.addId=n.addId.bind(Object(p.a)(n)),n.deleteId=n.deleteId.bind(Object(p.a)(n)),n.changeId=n.changeId.bind(Object(p.a)(n)),n.checkIdsCount=n.checkIdsCount.bind(Object(p.a)(n)),n}return Object(h.a)(a,[{key:"selectItemType",value:function(e){Object(te.a)(Object(ae.a)(a.prototype),"selectItemType",this).call(this,e),"id"==e.target.value&&0==this.state.item.ids.length?this.addId():this.state.item.ids.length>0&&this.deleteId()}},{key:"changeId",value:function(e){var t=this,a=e.currentTarget.name,n=e.currentTarget.value;this.props.cc.setState((function(e){return""!=n&&isNaN(n)||(t.state.item.ids[a]=n),e}))}},{key:"getIdsMap",value:function(){var e=this;return this.state.item.ids.map((function(t,a){var n;return s.a.createElement(F.a,{hidden:e.setFieldHidden("id")},s.a.createElement(U.d,(n={name:a,value:t,type:"text",placeholder:"ID \u043c\u0435\u0434\u0438\u0430\u0432\u043b\u043e\u0436\u0435\u043d\u0438\u044f"},Object(ee.a)(n,"value",e.state.item.ids[a]),Object(ee.a)(n,"onChange",e.changeId),n)))}))}},{key:"addId",value:function(e){var t=this;this.props.cc.setState((function(e){return t.state.item.ids.push(""),e}))}},{key:"deleteId",value:function(e){var t=this;this.props.cc.setState((function(e){return t.state.item.ids.pop(),e}))}},{key:"checkIdsCount",value:function(){var e=0;return this.props.cc.idsItems.forEach((function(t){return e+=t.ids.length})),e<10}},{key:"fields",value:function(){return s.a.createElement(Q.a,null,s.a.createElement(F.a,null,s.a.createElement(U.e,{placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0442\u0438\u043f",onChange:this.selectItemType},s.a.createElement("option",{value:"id"},"\u041f\u043e ID"),s.a.createElement("option",{value:"random"},"\u0421\u043b\u0443\u0447\u0430\u0439\u043d\u043e\u0435"))),s.a.createElement(F.a,{hidden:null==this.state.item.type},s.a.createElement(U.d,{type:"text",placeholder:"ID \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0430",name:"owner",value:this.state.item.owner,onChange:this.changeField})),s.a.createElement(F.a,{hidden:this.setFieldHidden("random")},s.a.createElement(U.d,{type:"text",placeholder:"ID \u0430\u043b\u044c\u0431\u043e\u043c\u0430",name:"album",value:this.state.item.album,onChange:this.changeField})),this.getIdsMap(),s.a.createElement(F.a,{hidden:this.setFieldHidden("id")},s.a.createElement(x.a,{size:"m",disabled:!this.checkIdsCount(),onClick:this.addId},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c ID"),s.a.createElement(x.a,{size:"m",disabled:this.state.item.ids.length<=1,onClick:this.deleteId},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c ID")))}}]),a}(Y),se=Object(U.f)(),ie=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(){var e;return Object(m.a)(this,a),(e=t.call(this)).state={comName:"",text:{name:"text",rusName:"\u0442\u0435\u043a\u0441\u0442",status:!1,text:""},post:{name:"post",rusName:"\u043f\u043e\u0441\u0442",status:!1,type:null,owner:"",id:"",number:""},image:{name:"image",rusName:"\u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435",status:!1,type:null,owner:"",album:"",ids:[]},video:{name:"video",rusName:"\u0432\u0438\u0434\u0435\u043e",status:!1,type:null,owner:"",album:"",ids:[]}},e.idsItems=[e.state.image,e.state.video],e.createCommand=e.createCommand.bind(Object(p.a)(e)),e.changeName=e.changeName.bind(Object(p.a)(e)),e.validateEmpty=e.validateEmpty.bind(Object(p.a)(e)),e.getAlert=e.getAlert.bind(Object(p.a)(e)),e.validateStatus=e.validateStatus.bind(Object(p.a)(e)),e.validate=e.validate.bind(Object(p.a)(e)),e}return Object(h.a)(a,[{key:"changeName",value:function(e){var t=this,a=e.currentTarget.value;this.setState((function(e){return a.includes(" ")||a.includes("\n")||(t.state.comName=a),e}))}},{key:"validateStatus",value:function(){var e=[this.state.text,this.state.post,this.state.image,this.state.video];for(var t in e){if(e[t].status)return!0}return!1}},{key:"validateEmpty",value:function(){var e=[];if(this.state.text.status&&e.push(this.state.text.text),this.state.post.status)switch(e.push(this.state.post.owner),this.state.post.type){case"id":e.push(this.state.post.id);break;case"number":e.push(this.state.post.number)}if(this.state.image.status&&(e.push(this.state.image.owner),"id"===this.state.image.type))for(var t in this.state.image.ids)e.push(this.state.image.ids[t]);if(this.state.video.status&&(e.push(this.state.video.owner),"id"===this.state.video.type))for(var t in this.state.video.ids)e.push(this.state.video.ids[t]);for(var t in e){var a=e[t];if(null==a||""==a.trim())return!1}return!0}},{key:"getAlert",value:function(e){var t=this;return s.a.createElement(W.a,{actions:[{title:"\u041e\u041a",mode:"cancel",autoclose:!0}],onClose:function(){return t.props.app.setPopout(null)}},s.a.createElement("p",null,e))}},{key:"validate",value:function(){var e=this,t=function(t){return e.props.app.setPopout(e.getAlert(t))};return null==this.state.comName||""==this.state.comName.trim()?t("\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c!"):this.validateStatus()?this.validateEmpty()?void this.createCommand():t("\u041d\u0435 \u0432\u0441\u0435 \u043f\u043e\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u044b!"):t("\u041e\u0442\u0432\u0435\u0442 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c!")}},{key:"createCommand",value:function(){var e=this,t=function(e){return Number(null!==e&&void 0!==e?e:0)},a=function(e){return e.map((function(e){return null!==e&&void 0!==e?e:0})).join(" ")},n=function(e){return null!=e.type&&e.type.length>0},i={Name:this.state.comName,Text:this.state.text.text,Author:{Id:t(this.props.userId)},Post:n(this.state.post)?{Type:this.state.post.type,OwnerId:t(this.state.post.owner),PostId:t(this.state.post.id),Number:t(this.state.post.number)}:null,Image:n(this.state.image)?{Type:this.state.image.type,OwnerId:t(this.state.image.owner),AlbumId:t(this.state.image.album),Ids:a(this.state.image.ids)}:null,Video:n(this.state.video)?{Type:this.state.video.type,OwnerId:t(this.state.video.owner),AlbumId:t(this.state.video.album),Ids:a(this.state.video.ids)}:null};q.queryPOST("create_command",i),this.props.app.go({currentTarget:{dataset:{to:"home"}}}),this.props.app.setPopout(s.a.createElement(W.a,{actions:[{title:"\u041e\u041a",mode:"cancel",autoclose:!0}],onClose:function(){return e.props.app.setPopout(null)}},s.a.createElement("p",null,"\u041a\u043e\u043c\u0430\u043d\u0434\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0430!")))}},{key:"render",value:function(){return s.a.createElement(I.a,{id:this.props.id},s.a.createElement(k.a,{left:s.a.createElement(R.a,{onClick:this.props.go,"data-to":"home"},se===U.c?s.a.createElement(M.a,null):s.a.createElement(J.a,null))},"RoyBot | \u041a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440 \u043a\u043e\u043c\u0430\u043d\u0434"),s.a.createElement(U.a,null,s.a.createElement(U.b,null,s.a.createElement(N.a,{header:s.a.createElement(B.a,{mode:"secondary"},"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0439 \u043a\u043e\u043c\u0430\u043d\u0434\u044b")},s.a.createElement(F.a,null,s.a.createElement(U.d,{type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u044b",value:this.state.comName,onChange:this.changeName}))),s.a.createElement(Z,{cc:this,item:this.state.text}),s.a.createElement($,{cc:this,item:this.state.post}),s.a.createElement(ne,{cc:this,item:this.state.image}),s.a.createElement(ne,{cc:this,item:this.state.video}))),s.a.createElement(F.a,null,s.a.createElement(N.a,null,s.a.createElement(L,{cc:this,item:this.state.text}),s.a.createElement(L,{cc:this,item:this.state.post}),s.a.createElement(L,{cc:this,item:this.state.image}),s.a.createElement(L,{cc:this,item:this.state.video})),s.a.createElement(N.a,null,s.a.createElement(F.a,null,s.a.createElement(x.a,{size:"xl",onClick:this.validate},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043a\u043e\u043c\u0430\u043d\u0434\u0443")))))}}]),a}(s.a.Component),re=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(){var e;function n(){return(n=Object(d.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.send("VKWebAppGetUserInfo");case 2:a=e.sent,t.setState((function(e){return e.fetchedUser=a,e.popout=null,e}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(m.a)(this,a),(e=t.call(this)).state={fetchedUser:null,activePanel:"home",popout:s.a.createElement(E.a,{size:"large"})},e.getParam=e.getParam.bind(Object(p.a)(e)),e.go=e.go.bind(Object(p.a)(e)),e.setPopout=e.setPopout.bind(Object(p.a)(e)),function(e){n.apply(this,arguments)}(Object(p.a)(e)),e}return Object(h.a)(a,[{key:"getParam",value:function(e){var t=window.location.search;return!!(t=t.match(new RegExp(e+"=([^&=]+)")))&&t[1]}},{key:"go",value:function(e){var t=e.currentTarget.dataset.to;this.setState((function(e){return e.activePanel=t,e}))}},{key:"setPopout",value:function(e){this.setState((function(t){return t.popout=e,t}))}},{key:"render",value:function(){var e=this.getParam("user_id");return s.a.createElement(g.a,{activePanel:this.state.activePanel,popout:this.state.popout},s.a.createElement(D,{id:"home",user:this.state.fetchedUser,go:this.go,userId:e,app:this}),s.a.createElement(ie,{id:"com_constructor",go:this.go,userId:e,app:this}))}}]),a}(s.a.Component);l.a.send("VKWebAppInit"),l.a.subscribe((function(e){var t=e.detail,a=t.type,n=t.data;if("VKWebAppUpdateConfig"===a){var s=document.createAttribute("scheme");s.value=n.scheme?n.scheme:"client_light",document.body.attributes.setNamedItem(s)}})),r.a.render(s.a.createElement(re,null),document.getElementById("root"))}},[[196,1,2]]]);
//# sourceMappingURL=main.39c220a6.chunk.js.map